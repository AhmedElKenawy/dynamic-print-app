<!-- Report Print Template -->
<div [class]="getContainerClasses().join(' ')" [attr.dir]="isRtl() ? 'rtl' : 'ltr'">
  
  <!-- Watermark (if enabled) -->
  <div class="watermark" *ngIf="watermark()">{{ watermark() }}</div>

  <!-- Report Cover/Header -->
  <div class="report-cover">
    <!-- Company Logo -->
    <div class="cover-logo" *ngIf="data.company?.logo">
      <img [src]="data.company!.logo" [alt]="data.company!.name || 'Company Logo'">
    </div>

    <!-- Report Title -->
    <h1 class="report-title">{{ data.title }}</h1>
    
    <!-- Subtitle -->
    <h2 class="report-subtitle" *ngIf="data.subtitle">{{ data.subtitle }}</h2>

    <!-- Report Metadata -->
    <div class="report-metadata">
      <div class="metadata-item" *ngIf="data.reportPeriod">
        <span class="metadata-label">Report Period:</span>
        <span class="metadata-value">{{ data.reportPeriod }}</span>
      </div>
      <div class="metadata-item">
        <span class="metadata-label">Report Date:</span>
        <span class="metadata-value">{{ getReportDate() }}</span>
      </div>
      <div class="metadata-item" *ngIf="data.generatedBy">
        <span class="metadata-label">Generated By:</span>
        <span class="metadata-value">{{ data.generatedBy }}</span>
      </div>
    </div>

    <!-- Company Info -->
    <div class="cover-company" *ngIf="data.company">
      <p class="company-name" *ngIf="data.company.name">{{ data.company.name }}</p>
      <p *ngIf="data.company.address">{{ data.company.address }}</p>
      <p *ngIf="data.company.phone || data.company.email">
        <span *ngIf="data.company.phone">{{ data.company.phone }}</span>
        <span *ngIf="data.company.phone && data.company.email"> | </span>
        <span *ngIf="data.company.email">{{ data.company.email }}</span>
      </p>
      <p *ngIf="data.company.website">{{ data.company.website }}</p>
    </div>
  </div>

  <!-- Page Break After Cover -->
  <div class="page-break"></div>

  <!-- Report Content Sections -->
  <div class="report-content">
    <div 
      *ngFor="let section of data.sections; let i = index"
      class="report-section avoid-break"
      [class.page-break]="section.pageBreakAfter">
      
      <!-- Section Title -->
      <h2 class="section-title">
        <span class="section-number">{{ i + 1 }}.</span>
        {{ section.title }}
      </h2>

      <!-- Section Content -->
      <div class="section-content" *ngIf="section.content">
        <p class="section-text">{{ section.content }}</p>
      </div>

      <!-- Section Subsections -->
      <div class="subsections" *ngIf="section.subsections && section.subsections.length > 0">
        <div 
          *ngFor="let subsection of section.subsections; let j = index"
          class="subsection avoid-break">
          
          <h3 class="subsection-title">
            <span class="subsection-number">{{ i + 1 }}.{{ j + 1 }}</span>
            {{ subsection.title }}
          </h3>
          
          <div class="subsection-content" *ngIf="subsection.content">
            <p class="subsection-text">{{ subsection.content }}</p>
          </div>

          <!-- Subsection Data -->
          <div class="data-container" *ngIf="subsection.data">
            <!-- Object Data (Key-Value Pairs) -->
            <div class="data-keyvalue" *ngIf="isObject(subsection.data) && !isArray(subsection.data)">
              <div 
                *ngFor="let key of getObjectKeys(subsection.data)"
                class="keyvalue-row">
                <span class="key">{{ formatHeader(key) }}:</span>
                <span class="value">{{ formatDataValue(subsection.data[key]) }}</span>
              </div>
            </div>

            <!-- Table Data -->
            <table 
              class="data-table" 
              *ngIf="isTableData(subsection.data)">
              <thead>
                <tr>
                  <th *ngFor="let header of getTableHeaders(subsection.data)">
                    {{ formatHeader(header) }}
                  </th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let row of subsection.data">
                  <td *ngFor="let header of getTableHeaders(subsection.data)">
                    {{ formatDataValue(row[header]) }}
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Section Data -->
      <div class="data-container" *ngIf="section.data && hasSectionContent(section)">
        <!-- Object Data (Key-Value Pairs) -->
        <div class="data-keyvalue" *ngIf="isObject(section.data) && !isArray(section.data)">
          <div 
            *ngFor="let key of getObjectKeys(section.data)"
            class="keyvalue-row">
            <span class="key">{{ formatHeader(key) }}:</span>
            <span class="value">{{ formatDataValue(section.data[key]) }}</span>
          </div>
        </div>

        <!-- Table Data -->
        <table 
          class="data-table" 
          *ngIf="isTableData(section.data)">
          <thead>
            <tr>
              <th *ngFor="let header of getTableHeaders(section.data)">
                {{ formatHeader(header) }}
              </th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let row of section.data">
              <td *ngFor="let header of getTableHeaders(section.data)">
                {{ formatDataValue(row[header]) }}
              </td>
            </tr>
          </tbody>
        </table>
      </div>

    </div>
  </div>

  <!-- Summary Section -->
  <div class="report-summary" *ngIf="hasSummary()">
    <div class="page-break-before"></div>
    
    <h2 class="summary-title">{{ data.summary?.title || 'Summary' }}</h2>

    <!-- Highlighted Items (Big Cards) -->
    <div class="summary-highlights" *ngIf="getHighlightedItems().length > 0">
      <div 
        *ngFor="let item of getHighlightedItems()"
        class="highlight-card">
        <div class="highlight-value">{{ formatSummaryValue(item.value) }}</div>
        <div class="highlight-label">{{ item.label }}</div>
      </div>
    </div>

    <!-- Regular Items (List) -->
    <div class="summary-items" *ngIf="getRegularItems().length > 0">
      <div 
        *ngFor="let item of getRegularItems()"
        class="summary-item">
        <span class="item-label">{{ item.label }}:</span>
        <span class="item-value">{{ formatSummaryValue(item.value) }}</span>
      </div>
    </div>
  </div>

  <!-- Report Footer -->
  <div class="report-footer" *ngIf="data.footer || showFooter()">
    <div class="footer-divider"></div>
    <div class="footer-content">
      <p class="footer-text" *ngIf="data.footer">{{ data.footer }}</p>
      <p class="footer-generated">
        Generated on {{ getCurrentDateTime() }}
      </p>
    </div>
  </div>

</div>

